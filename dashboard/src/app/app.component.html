@if (!apiKey()) {
  <mat-card class="login-card">
    <mat-card-title>Enter API Key</mat-card-title>
    <mat-card-content>
      <form
        (ngSubmit)="saveApiKey()"
        #apiKeyForm="ngForm"
        style="display: flex; flex-direction: column; gap: 16px"
      >
        <mat-form-field appearance="fill">
          <mat-label>API Key</mat-label>
          <input
            matInput
            type="text"
            name="apiKey"
            [ngModel]="inputApiKey()"
            (ngModelChange)="inputApiKey.set($event)"
            required
            autocomplete="off"
          />
        </mat-form-field>
        <button
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="!inputApiKey()"
        >
          Save
        </button>
      </form>
    </mat-card-content>
  </mat-card>
} @else {
  <div class="background-image"></div>
  <div class="app-vertical-stack">
    <div class="dashboard-main-container">
      <div class="frosted-glass-container">
        <div class="dashboard-header">
          <h1>Dashboard InstaSwiss</h1>
          <div class="subtitle">API Key saved</div>
        </div>
        <div class="dashboard-content">
          <div class="dashboard-card">
            <div class="card-title">Number of Hikes</div>
            <div class="hike-count">{{ hikeCount() === null ? 'Loading...' : hikeCount() }}</div>
          </div>
          <div class="dashboard-card">
            <div class="card-title">To-Dos</div>
            <ul class="todo-list">
              <li>Correct Telephone Number</li>
              <li>Correct Opening Hours Format</li>
              <li>Correct Webcam Image URL</li>
            </ul>
          </div>
        </div>
        <button class="run-tests-btn" (click)="runTests()">Run Tests</button>
      </div>
    </div>
    @if (testsLoading() || testResults()?.length) {
      <div class="frosted-glass-container test-results-container">
        <div class="dashboard-header">
          <h2>Test Results</h2>
        </div>
        <div class="test-results-list">
          @if (testsLoading()) {
            <div class="spinner"></div>
          } @else {
            @for (result of testResults(); track result.name) {
              <div class="test-result-item" [ngClass]="{passed: result.passed, failed: !result.passed}">
                <div class="result-title">{{ result.name }}</div>
                <div class="result-message">{{ result.message }}</div>
              </div>
            }
          }
        </div>
      </div>
    }
  </div>
}
